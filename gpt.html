<!DOCTYPE html>
<html>
<head>
  <title>ChatGPT</title>
  <style>
    /* CSS styles for the ChatGPT window */
    /* ... Your CSS styles here ... */
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@openai/chat-dvaas"></script>
  <script>
    // Function to handle messages received from the parent window
    window.addEventListener("message", function(event) {
      var promptText = event.data;
      var chatContainer = document.getElementById("chat-container");
      var chatbox = document.getElementById("chatbox");
      var chatOption = "chatbox";

      function addUserMessage(message) {
        // ... Your code here ...
      }

      function addChatGPTMessage(message) {
        // ... Your code here ...
      }

      function sendMessage() {
        // ... Your code here ...
      }

      function typeOutResponse(message) {
        // ... Your code here ...
      }

      // Handle user input form submission
      var userForm = document.getElementById("user-form");
      userForm.addEventListener("submit", function(event) {
        event.preventDefault();
        sendMessage();
      });

      // Handle close button click
      var closeButton = document.getElementById("close-button");
      closeButton.addEventListener("click", function() {
        window.close();
      });

      // Handle option selection
      var optionSelect = document.getElementById("option-select");
      optionSelect.addEventListener("change", function() {
        chatOption = optionSelect.value;
      });

      // Show initial message
      addChatGPTMessage("Hello, I'm ChatGPT! How can I assist you?");

      // Initialize OpenAI API client
      var apiKey = atob("c2stY2tYZ1BnQ3ZCSDVuOGFCZ2xsSUNUM0JlbkFJZ242S0Z4Y2QUPDdkY2FkS2V5");
      var apiUrl = "https://api.openai.com/v1/chat/completions";
      var chatApi = new OpenAIChatApi(apiUrl, apiKey);

      // Send user input and receive chat model response
      async function sendMessage() {
        var userInput = document.getElementById("user-input");
        var message = userInput.value.trim();
        if (message !== "") {
          addUserMessage(message);
          userInput.value = "";
          var response = await chatApi.sendMessage(message);
          var chatMessage = response.choices[0].message.content;
          if (chatOption === "chatbox") {
            addChatGPTMessage(chatMessage);
          } else if (chatOption === "typing") {
            typeOutResponse(chatMessage);
          }
        }
      }
    });

    // Notify the parent window that the ChatGPT window has loaded
    window.opener.postMessage("ChatGPTWindowLoaded", "*");
  </script>
</head>
<body>
  <div class="chat-container">
    <h1>ChatGPT</h1>
    <div id="chatbox" class="chatbox"></div>
    <form id="user-form">
      <input type="text" id="user-input" class="user-input" placeholder="Type your message...">
      <button type="submit">Send</button>
    </form>
    <label for="option-select">Response Display Option:</label>
    <select id="option-select">
      <option value="chatbox" selected>Chatbox</option>
      <option value="typing">Typing</option>
    </select>
    <button id="close-button">Close</button>
  </div>
</body>
</html>
